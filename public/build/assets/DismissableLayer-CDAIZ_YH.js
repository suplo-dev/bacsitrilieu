import{i as A,a as T,q as I}from"./useForwardExpose-B_7orc_o.js";import{h as L,j as m,O as C,d as B,c as h,Q as S,f as W,o as N,w as _,k as z,u as D,A as R}from"./app-D0CLxdAZ.js";import{P as U}from"./createLucideIcon-C7Et0u9z.js";const q=["INPUT","TEXTAREA"];function G(e,t,i,s={}){if(!t||s.enableIgnoredElement&&q.includes(t.nodeName))return null;const{arrowKeyOptions:r="both",attributeName:o="[data-reka-collection-item]",itemsArray:u=[],loop:a=!0,dir:f="ltr",preventScroll:v=!0,focus:E=!1}=s,[y,w,O,n,d,l]=[e.key==="ArrowRight",e.key==="ArrowLeft",e.key==="ArrowUp",e.key==="ArrowDown",e.key==="Home",e.key==="End"],g=O||n,P=y||w;if(!d&&!l&&(!g&&!P||r==="vertical"&&P||r==="horizontal"&&g))return null;const b=i?Array.from(i.querySelectorAll(o)):u;if(!b.length)return null;v&&e.preventDefault();let p=null;return P||g?p=k(b,t,{goForward:g?n:f==="ltr"?y:w,loop:a}):d?p=b.at(0)||null:l&&(p=b.at(-1)||null),E&&(p==null||p.focus()),p}function k(e,t,i,s=e.length){if(--s===0)return null;const r=e.indexOf(t),o=i.goForward?r+1:r-1;if(!i.loop&&(o<0||o>=e.length))return null;const u=(o+e.length)%e.length,a=e[u];return a?a.hasAttribute("disabled")&&a.getAttribute("disabled")!=="false"?k(e,a,i,s):a:null}function x(e,t,i){const s=i.originalEvent.target,r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});t&&s.addEventListener(e,t,{once:!0}),s.dispatchEvent(r)}const H="dismissableLayer.pointerDownOutside",K="dismissableLayer.focusOutside";function F(e,t){const i=t.closest("[data-dismissable-layer]"),s=e.dataset.dismissableLayer===""?e:e.querySelector("[data-dismissable-layer]"),r=Array.from(e.ownerDocument.querySelectorAll("[data-dismissable-layer]"));return!!(i&&s===i||r.indexOf(s)<r.indexOf(i))}function j(e,t){var o;const i=((o=t==null?void 0:t.value)==null?void 0:o.ownerDocument)??(globalThis==null?void 0:globalThis.document),s=L(!1),r=L(()=>{});return m(u=>{if(!A)return;const a=async v=>{const E=v.target;if(t!=null&&t.value){if(F(t.value,E)){s.value=!1;return}if(v.target&&!s.value){let y=function(){x(H,e,w)};const w={originalEvent:v};v.pointerType==="touch"?(i.removeEventListener("click",r.value),r.value=y,i.addEventListener("click",r.value,{once:!0})):y()}else i.removeEventListener("click",r.value);s.value=!1}},f=window.setTimeout(()=>{i.addEventListener("pointerdown",a)},0);u(()=>{window.clearTimeout(f),i.removeEventListener("pointerdown",a),i.removeEventListener("click",r.value)})}),{onPointerDownCapture:()=>s.value=!0}}function M(e,t){var r;const i=((r=t==null?void 0:t.value)==null?void 0:r.ownerDocument)??(globalThis==null?void 0:globalThis.document),s=L(!1);return m(o=>{if(!A)return;const u=async a=>{t!=null&&t.value&&(await C(),await C(),!(!t.value||F(t.value,a.target))&&a.target&&!s.value&&x(K,e,{originalEvent:a}))};i.addEventListener("focusin",u),o(()=>i.removeEventListener("focusin",u))}),{onFocusCapture:()=>s.value=!0,onBlurCapture:()=>s.value=!1}}const c=S({layersRoot:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),J=B({__name:"DismissableLayer",props:{disableOutsidePointerEvents:{type:Boolean,default:!1},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","dismiss"],setup(e,{emit:t}){const i=e,s=t,{forwardRef:r,currentElement:o}=T(),u=h(()=>{var n;return((n=o.value)==null?void 0:n.ownerDocument)??globalThis.document}),a=h(()=>c.layersRoot),f=h(()=>o.value?Array.from(a.value).indexOf(o.value):-1),v=h(()=>c.layersWithOutsidePointerEventsDisabled.size>0),E=h(()=>{const n=Array.from(a.value),[d]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),l=n.indexOf(d);return f.value>=l}),y=j(async n=>{const d=[...c.branches].some(l=>l==null?void 0:l.contains(n.target));!E.value||d||(s("pointerDownOutside",n),s("interactOutside",n),await C(),n.defaultPrevented||s("dismiss"))},o),w=M(n=>{[...c.branches].some(l=>l==null?void 0:l.contains(n.target))||(s("focusOutside",n),s("interactOutside",n),n.defaultPrevented||s("dismiss"))},o);I("Escape",n=>{f.value===a.value.size-1&&(s("escapeKeyDown",n),n.defaultPrevented||s("dismiss"))});let O;return m(n=>{o.value&&(i.disableOutsidePointerEvents&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(O=u.value.body.style.pointerEvents,u.value.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(o.value)),a.value.add(o.value),n(()=>{i.disableOutsidePointerEvents&&c.layersWithOutsidePointerEventsDisabled.size===1&&(u.value.body.style.pointerEvents=O)}))}),m(n=>{n(()=>{o.value&&(a.value.delete(o.value),c.layersWithOutsidePointerEventsDisabled.delete(o.value))})}),(n,d)=>(N(),W(D(U),{ref:D(r),"as-child":n.asChild,as:n.as,"data-dismissable-layer":"",style:R({pointerEvents:v.value?E.value?"auto":"none":void 0}),onFocusCapture:D(w).onFocusCapture,onBlurCapture:D(w).onBlurCapture,onPointerdownCapture:D(y).onPointerDownCapture},{default:_(()=>[z(n.$slots,"default")]),_:3},8,["as-child","as","style","onFocusCapture","onBlurCapture","onPointerdownCapture"]))}});export{J as _,x as h,G as u};
